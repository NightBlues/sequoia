OASISFormat:  0.4
Name:         sequoia
OCamlVersion: >= 4.04.0
Version:      0.0.0
Synopsis:     Type-safe SQL library and syntax extension
Authors:      Andre Nathan
License:      MIT

BuildTools:   ocamlbuild
Plugins:      DevFiles (0.4), META (0.4)

Library "sequoia"
  FindlibName:      sequoia
  Path:             lib
  Modules:          Sequoia

Flag mysql
  Description:      Build the MySQL driver
  Default:          true

Library "sequoia_mysql"
  Build$:           flag(mysql)
  Install$:         flag(mysql)
  FindlibParent:    sequoia
  FindlibName:      mysql
  Path:             lib/mysql
  BuildDepends:     sequoia,
                    unix
  Modules:          Sequoia_mysql

Flag sqlite
  Description:      Build the SQLite driver
  Default:          true

Library "sequoia_sqlite"
  Build$:           flag(sqlite)
  Install$:         flag(sqlite)
  FindlibParent:    sequoia
  FindlibName:      sqlite
  Path:             lib/sqlite
  BuildDepends:     sequoia
  Modules:          Sequoia_sqlite

Flag ppx
  Description:      Build the ppx syntax extension
  Default:          true

Library "sequoia_ppx"
  Build$:           flag(ppx)
  Install$:         flag(ppx)
  FindlibParent:    sequoia
  FindlibName:      ppx
  Path:             lib/ppx
  Modules:          Sequoia_ppx
  XMETARequires:    sequoia
  XMETAExtraLines:  ppx = "ppx_sequoia"

Executable "ppx_sequoia"
  Build$:           flag(ppx)
  Install$:         flag(ppx)
  Path:             lib/ppx
  MainIs:           ppx_sequoia.ml
  BuildDepends:     compiler-libs.common,
                    ppx_tools
  CompiledObject:   best

Executable "ppx_test"
  Build$:           flag(ppx)
  Install:          false
  Path:             lib_test/ppx
  MainIs:           t.ml
  BuildTools:       ppx_sequoia
  BuildDepends:     sequoia, sequoia.mysql
  CompiledObject:   best
